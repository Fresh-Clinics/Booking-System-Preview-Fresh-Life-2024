eventContent: function (arg) {
    if (arg.event && arg.event.title) {
        return {
            html: `<div class="fc-event-content">
                      <div class="fc-event-title">${arg.event.title}</div>
                   </div>`
        };
    } else {
        return { html: '<div class="fc-event-content"><div class="fc-event-title">Invalid Event</div></div>' };
    }
},
eventDidMount: function (info) {
    tippy(info.el, {
        content: `<strong>${info.event.title}</strong><br>${info.event.extendedProps.description}`,
        allowHTML: true,
        theme: 'light-border',
        placement: 'top'
    });
},
eventClick: function (info) {
    const event = info.event;
    const popup = document.createElement('div');
    popup.className = 'popup-overlay';
    popup.innerHTML = `
        <div class="popup-content">
            <span class="close-popup" onclick="this.parentElement.parentElement.remove()">Ã—</span>
            <h2>${event.title}</h2>
            <p>${event.extendedProps.description}</p>
        </div>
    `;
    document.body.appendChild(popup);
},
fetchEventStartTime(token, eventId, unitId, from, to, callback) {
    var client = new JSONRpcClient({
        'url': 'https://user-api.simplybook.me',
        'headers': {
            'X-Company-Login': 'thefreshlifeconference',
            'X-Token': token
        },
        'onerror': function (error) {
            console.error("Error in JSON-RPC client setup:", error);
        }
    });

    client.request('getStartTimeMatrix', [from, from, eventId, [unitId], 1, null, []], function (timeMatrix) {
        console.log("Fetched start times for event:", timeMatrix);
        if (timeMatrix && Object.keys(timeMatrix).length > 0) {
            const firstDate = Object.keys(timeMatrix)[0]; // Get the first available date
            const startTime = timeMatrix[firstDate][0];   // Get the first available time
            const fullStartTime = `${firstDate}T${startTime}`; // Combine to full ISO date-time string
            callback(fullStartTime);
        } else {
            console.error("No start time available for the given parameters.");
            callback(null);
        }
    }, function (error) {
        console.error("Error fetching start times:", error);
        callback(null);
    });
}
